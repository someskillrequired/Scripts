import subprocess

password_list = [
"2025656990-254722460-3866451362025656990-254722460-386645136334454FADSFASDF45345",
"2025656990-254722460-3866451362025656990-254722460-386645136334454FADSFASDF45345",
"1688788812-163327433-2005584771",
"-831217260-1747352550571668361",
"-1009579042-1648376652055914510",
"14586054761840307205866677296578985043718542319410896960",
"5343467961632799232325383436532384884044352693324011072",
"62353416924857958401381466656419652805574272386998254592",
"33914133316598072324083847060831670643001194021041492416",
"228351699595533107210444605218407167848619448105630859520",
"88815041810357212163106267541298714963725007713788073920",
"10126477790829158405239290487429854244748767786932726016",
"84498987182130135049127638725952830408254019121664566272",
"52656440003749478409753874821158501764273508323512291328",
"4348760553826308096689143369271730722700195121383061248",
"4901996172917204480426869443125467281481676960437435968",
"462763014322229811210259142717978854646405398532625195584",
"4821499339052417024585771626013787392314697770866376704",
"7977190921094611456184279887675285240539260527065108544",
"847906514727626342411581786159576275844575178369129803776",
"85790653723346247684089227304839383207817824917487780096",
"82001127695632911365877316740273057847290362103419100224",
"27743254961699921928521052570851923366158315762194927872",
"35188106402069273601689493050324845041139206241947911616",
"527309404688875980810657962244892202968446628016087688128",
"85439748914001146889409998616422144721535933820009829440",
"6917352825500996096992582319556126920158512218306714688",
"4050989873366401024864143524959514562370970596173241344",
"76681286009230504966997266998237534163094264124913949760",
"27202759075398896643000749319571433524810462371183387584",
"573364661945635328373288836890236728345032893388874688",
"68555756019326694407729406047568467927674347756059943872",
"66126543156040217605929305516895168562150281063845651392",
"237576374356623769660805381202909283448387726040764160",
"68212590650953774087652607690875094487265565485762300992",
"184119433407907788810218312307349682481411082061960623168",
"51131906237626035203059042320238836562735707581265229888",
"80386047001651118088729543901059215681928195234825108480",
"52213634439170293765115018160752753604868163060867980288",
"61661966454186071047211994691990119601604458135194093504",
"18213798480240025602246940192497040489185891534379503360",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"3324176150215720963793829935903220162189107189609358336",
"3324176150215720963793829935903220162189107189609358336",
"3324176150215720963793829935903220162189107189609358336",
"3324176150215720963793829935903220162189107189609358336",
"3324176150215720963793829935903220162189107189609358336",
"3324176150215720963793829935903220162189107189609358336",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"3324176150215720963793829935903220162189107189609358336",
"3324176150215720963793829935903220162189107189609358336",
"3324176150215720963793829935903220162189107189609358336",
"3324176150215720963793829935903220162189107189609358336",
"3324176150215720963793829935903220162189107189609358336",
"3324176150215720963793829935903220162189107189609358336",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328",
"52656440003749478409753874821158501764273508323512291328"]

password_list = list(set(password_list))

def unzip_file_with_7zip(input, output, password_list):
    sevenzip_executable = r'C:\Program Files\7-Zip\7z.exe'  # Adjust the path based on your installation
    for password in password_list:
        try:
            command = [
                sevenzip_executable,
                'x',  # Extract files with full paths
                '-y',  # Assume Yes on all queries (overwrite files without prompting)
                f'-p{password}',  # Password for the archive
                f'-o{output}',  # Output directory
                input  # The path of the archive to extract
            ]
            subprocess.run(command, check=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
            print(f"Successfully extracted with password: {password}")
            return True
        except subprocess.CalledProcessError:
            print(f"Failed to extract with password: {password}. Trying next...")

    print("All passwords attempted. Unable to extract the file.")
    return False

# Example usage
file_path = 'D:/SteamLibrary/steamapps/common/They Are Billions/SniperEdition.dat'
output_path = 'D:/SteamLibrary/steamapps/common/They Are Billions/ZXGame_Data/Images/Campaign/'
unzip_file_with_7zip(file_path, output_path,password_list)

